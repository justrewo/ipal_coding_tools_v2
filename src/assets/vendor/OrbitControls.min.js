THREE.OrbitControls=function(e,t){this.object=e;this.domElement=t!==undefined?t:document;this.enabled=true;this.target=new THREE.Vector3;this.minDistance=0;this.maxDistance=Infinity;this.minZoom=0;this.maxZoom=Infinity;this.minPolarAngle=0;this.maxPolarAngle=Math.PI;this.minAzimuthAngle=-Infinity;this.maxAzimuthAngle=Infinity;this.enableDamping=false;this.dampingFactor=.25;this.enableZoom=true;this.zoomSpeed=1;this.enableRotate=true;this.rotateSpeed=1;this.enablePan=true;this.keyPanSpeed=7;this.autoRotate=false;this.autoRotateSpeed=2;this.enableKeys=true;this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT};this.target0=this.target.clone();this.position0=this.object.position.clone();this.zoom0=this.object.zoom;this.getPolarAngle=function(){return l.phi};this.getAzimuthalAngle=function(){return l.theta};this.saveState=function(){n.target0.copy(n.target);n.position0.copy(n.object.position);n.zoom0=n.object.zoom};this.reset=function(){n.target.copy(n.target0);n.object.position.copy(n.position0);n.object.zoom=n.zoom0;n.object.updateProjectionMatrix();n.dispatchEvent(o);n.update();s=i.NONE};this.update=function(){var t=new THREE.Vector3;var a=(new THREE.Quaternion).setFromUnitVectors(e.up,new THREE.Vector3(0,1,0));var r=a.clone().inverse();var f=new THREE.Vector3;var h=new THREE.Quaternion;return function e(){var p=n.object.position;t.copy(p).sub(n.target);t.applyQuaternion(a);l.setFromVector3(t);if(n.autoRotate&&s===i.NONE){w(y())}l.theta+=u.theta;l.phi+=u.phi;l.theta=Math.max(n.minAzimuthAngle,Math.min(n.maxAzimuthAngle,l.theta));l.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,l.phi));l.makeSafe();l.radius*=m;l.radius=Math.max(n.minDistance,Math.min(n.maxDistance,l.radius));n.target.add(d);t.setFromSpherical(l);t.applyQuaternion(r);p.copy(n.target).add(t);n.object.lookAt(n.target);if(n.enableDamping===true){u.theta*=1-n.dampingFactor;u.phi*=1-n.dampingFactor}else{u.set(0,0,0)}m=1;d.set(0,0,0);if(E||f.distanceToSquared(n.object.position)>c||8*(1-h.dot(n.object.quaternion))>c){n.dispatchEvent(o);f.copy(n.object.position);h.copy(n.object.quaternion);E=false;return true}return false}}();this.dispose=function(){n.domElement.removeEventListener("contextmenu",ne,false);n.domElement.removeEventListener("mousedown",G,false);n.domElement.removeEventListener("wheel",Q,false);n.domElement.removeEventListener("touchstart",$,false);n.domElement.removeEventListener("touchend",te,false);n.domElement.removeEventListener("touchmove",ee,false);document.removeEventListener("mousemove",W,false);document.removeEventListener("mouseup",q,false);window.removeEventListener("keydown",J,false)};var n=this;var o={type:"change"};var a={type:"start"};var r={type:"end"};var i={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5};var s=i.NONE;var c=1e-6;var l=new THREE.Spherical;var u=new THREE.Spherical;var m=1;var d=new THREE.Vector3;var E=false;var f=new THREE.Vector2;var h=new THREE.Vector2;var p=new THREE.Vector2;var b=new THREE.Vector2;var v=new THREE.Vector2;var T=new THREE.Vector2;var g=new THREE.Vector2;var R=new THREE.Vector2;var O=new THREE.Vector2;function y(){return 2*Math.PI/60/60*n.autoRotateSpeed}function H(){return Math.pow(.95,n.zoomSpeed)}function w(e){u.theta-=e}function P(e){u.phi-=e}var j=function(){var e=new THREE.Vector3;return function t(n,o){e.setFromMatrixColumn(o,0);e.multiplyScalar(-n);d.add(e)}}();var C=function(){var e=new THREE.Vector3;return function t(n,o){e.setFromMatrixColumn(o,1);e.multiplyScalar(n);d.add(e)}}();var M=function(){var e=new THREE.Vector3;return function t(o,a){var r=n.domElement===document?n.domElement.body:n.domElement;if(n.object instanceof THREE.PerspectiveCamera){var i=n.object.position;e.copy(i).sub(n.target);var s=e.length();s*=Math.tan(n.object.fov/2*Math.PI/180);j(2*o*s/r.clientHeight,n.object.matrix);C(2*a*s/r.clientHeight,n.object.matrix)}else if(n.object instanceof THREE.OrthographicCamera){j(o*(n.object.right-n.object.left)/n.object.zoom/r.clientWidth,n.object.matrix);C(a*(n.object.top-n.object.bottom)/n.object.zoom/r.clientHeight,n.object.matrix)}else{console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.");n.enablePan=false}}}();function L(e){if(n.object instanceof THREE.PerspectiveCamera){m/=e}else if(n.object instanceof THREE.OrthographicCamera){n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*e));n.object.updateProjectionMatrix();E=true}else{console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.");n.enableZoom=false}}function N(e){if(n.object instanceof THREE.PerspectiveCamera){m*=e}else if(n.object instanceof THREE.OrthographicCamera){n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/e));n.object.updateProjectionMatrix();E=true}else{console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.");n.enableZoom=false}}function k(e){f.set(e.clientX,e.clientY)}function A(e){g.set(e.clientX,e.clientY)}function x(e){b.set(e.clientX,e.clientY)}function D(e){h.set(e.clientX,e.clientY);p.subVectors(h,f);var t=n.domElement===document?n.domElement.body:n.domElement;w(2*Math.PI*p.x/t.clientWidth*n.rotateSpeed);P(2*Math.PI*p.y/t.clientHeight*n.rotateSpeed);f.copy(h);n.update()}function U(e){R.set(e.clientX,e.clientY);O.subVectors(R,g);if(O.y>0){L(H())}else if(O.y<0){N(H())}g.copy(R);n.update()}function S(e){v.set(e.clientX,e.clientY);T.subVectors(v,b);M(T.x,T.y);b.copy(v);n.update()}function V(e){}function Z(e){if(e.deltaY<0){N(H())}else if(e.deltaY>0){L(H())}n.update()}function Y(e){switch(e.keyCode){case n.keys.UP:M(0,n.keyPanSpeed);n.update();break;case n.keys.BOTTOM:M(0,-n.keyPanSpeed);n.update();break;case n.keys.LEFT:M(n.keyPanSpeed,0);n.update();break;case n.keys.RIGHT:M(-n.keyPanSpeed,0);n.update();break}}function z(e){f.set(e.touches[0].pageX,e.touches[0].pageY)}function I(e){var t=e.touches[0].pageX-e.touches[1].pageX;var n=e.touches[0].pageY-e.touches[1].pageY;var o=Math.sqrt(t*t+n*n);g.set(0,o)}function F(e){b.set(e.touches[0].pageX,e.touches[0].pageY)}function X(e){h.set(e.touches[0].pageX,e.touches[0].pageY);p.subVectors(h,f);var t=n.domElement===document?n.domElement.body:n.domElement;w(2*Math.PI*p.x/t.clientWidth*n.rotateSpeed);P(2*Math.PI*p.y/t.clientHeight*n.rotateSpeed);f.copy(h);n.update()}function K(e){var t=e.touches[0].pageX-e.touches[1].pageX;var o=e.touches[0].pageY-e.touches[1].pageY;var a=Math.sqrt(t*t+o*o);R.set(0,a);O.subVectors(R,g);if(O.y>0){N(H())}else if(O.y<0){L(H())}g.copy(R);n.update()}function _(e){v.set(e.touches[0].pageX,e.touches[0].pageY);T.subVectors(v,b);M(T.x,T.y);b.copy(v);n.update()}function B(e){}function G(e){if(n.enabled===false)return;e.preventDefault();switch(e.button){case n.mouseButtons.ORBIT:if(n.enableRotate===false)return;k(e);s=i.ROTATE;break;case n.mouseButtons.ZOOM:if(n.enableZoom===false)return;A(e);s=i.DOLLY;break;case n.mouseButtons.PAN:if(n.enablePan===false)return;x(e);s=i.PAN;break}if(s!==i.NONE){document.addEventListener("mousemove",W,false);document.addEventListener("mouseup",q,false);n.dispatchEvent(a)}}function W(e){if(n.enabled===false)return;e.preventDefault();switch(s){case i.ROTATE:if(n.enableRotate===false)return;D(e);break;case i.DOLLY:if(n.enableZoom===false)return;U(e);break;case i.PAN:if(n.enablePan===false)return;S(e);break}}function q(e){if(n.enabled===false)return;V(e);document.removeEventListener("mousemove",W,false);document.removeEventListener("mouseup",q,false);n.dispatchEvent(r);s=i.NONE}function Q(e){if(n.enabled===false||n.enableZoom===false||s!==i.NONE&&s!==i.ROTATE)return;e.preventDefault();e.stopPropagation();Z(e);n.dispatchEvent(a);n.dispatchEvent(r)}function J(e){if(n.enabled===false||n.enableKeys===false||n.enablePan===false)return;Y(e)}function $(e){if(n.enabled===false)return;switch(e.touches.length){case 1:if(n.enableRotate===false)return;z(e);s=i.TOUCH_ROTATE;break;case 2:if(n.enableZoom===false)return;I(e);s=i.TOUCH_DOLLY;break;case 3:if(n.enablePan===false)return;F(e);s=i.TOUCH_PAN;break;default:s=i.NONE}if(s!==i.NONE){n.dispatchEvent(a)}}function ee(e){if(n.enabled===false)return;e.preventDefault();e.stopPropagation();switch(e.touches.length){case 1:if(n.enableRotate===false)return;if(s!==i.TOUCH_ROTATE)return;X(e);break;case 2:if(n.enableZoom===false)return;if(s!==i.TOUCH_DOLLY)return;K(e);break;case 3:if(n.enablePan===false)return;if(s!==i.TOUCH_PAN)return;_(e);break;default:s=i.NONE}}function te(e){if(n.enabled===false)return;B(e);n.dispatchEvent(r);s=i.NONE}function ne(e){e.preventDefault()}n.domElement.addEventListener("contextmenu",ne,false);n.domElement.addEventListener("mousedown",G,false);n.domElement.addEventListener("wheel",Q,false);n.domElement.addEventListener("touchstart",$,false);n.domElement.addEventListener("touchend",te,false);n.domElement.addEventListener("touchmove",ee,false);window.addEventListener("keydown",J,false);this.update()};THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype);THREE.OrbitControls.prototype.constructor=THREE.OrbitControls;Object.defineProperties(THREE.OrbitControls.prototype,{center:{get:function(){console.warn("THREE.OrbitControls: .center has been renamed to .target");return this.target}},noZoom:{get:function(){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.");return!this.enableZoom},set:function(e){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.");this.enableZoom=!e}},noRotate:{get:function(){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.");return!this.enableRotate},set:function(e){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.");this.enableRotate=!e}},noPan:{get:function(){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.");return!this.enablePan},set:function(e){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.");this.enablePan=!e}},noKeys:{get:function(){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.");return!this.enableKeys},set:function(e){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.");this.enableKeys=!e}},staticMoving:{get:function(){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.");return!this.enableDamping},set:function(e){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.");this.enableDamping=!e}},dynamicDampingFactor:{get:function(){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.");return this.dampingFactor},set:function(e){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.");this.dampingFactor=e}}});